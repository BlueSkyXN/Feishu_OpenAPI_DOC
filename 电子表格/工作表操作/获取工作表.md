# 获取工作表

最后更新于 2024-10-23

根据电子表格 token 获取表格中所有工作表及其属性信息，包括工作表 ID、标题、索引位置、是否被隐藏等。

## 前提条件

调用此接口前，请确保当前调用身份（tenant\_access\_token 或 user\_access\_token）已有电子表格的阅读、编辑等文档权限，否则接口将返回 HTTP 403 或 400 状态码。了解更多，参考[如何为应用或用户开通文档权限](https://open.feishu.cn/document/ukTMukTMukTM/uczNzUjL3czM14yN3MTN#16c6475a)。

## 请求

| 基本                      |                                                                                                                                      |
| --------------------------- | -------------------------------------------------------------------------------------------------------------------------------------- |
| HTTP URL                  | https://open.feishu.cn/open-apis/sheets/v3/spreadsheets/:spreadsheet\_token/sheets/query                                             |
| HTTP Method               | GET                                                                                                                                  |
| 接口频率限制              | [100 次/分钟](https://open.feishu.cn/document/ukTMukTMukTM/uUzN04SN3QjL1cDN)                                                            |
| 支持的应用类型            | **自建应用**商店应用                                                                                                                 |
| 权限要求 开启任一权限即可 | **查看、评论、编辑和管理云空间中所有文件**查看、评论和下载云空间中所有文件**查看、评论、编辑和管理电子表格**查看、评论和导出电子表格 |

### 请求头

| 名称          | 类型   | 必填 | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| --------------- | -------- | ------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Authorization | string | 是   | 应用调用 API 时，需要通过访问凭证（access\_token）进行身份鉴权，不同类型的访问凭证可获取的数据范围不同，参考 [选择并获取访问凭证](https://open.feishu.cn/document/ukTMukTMukTM/uMTNz4yM1MjLzUzM) 。​**值格式**​："Bearer `access_token`"​**可选值如下**​：tenant\_access\_token以应用身份调用 API，可读写的数据范围由应用自身的 [数据权限范围](https://open.feishu.cn/document/home/introduction-to-scope-and-authorization/configure-app-data-permissions)决定。参考 [自建应用获取 tenant\_access\_token](https://open.feishu.cn/document/ukTMukTMukTM/ukDNz4SO0MjL5QzM/auth-v3/auth/tenant_access_token_internal) 或 [商店应用获取 tenant\_access\_token](https://open.feishu.cn/document/ukTMukTMukTM/ukDNz4SO0MjL5QzM/auth-v3/auth/tenant_access_token) 。示例值："Bearer t-g1044qeGEDXTB6NDJOGV4JQCYDGHRBARFTGT1234"user\_access\_token以登录用户身份调用 API，可读写的数据范围由用户可读写的数据范围决定。参考 [获取 user\_access\_token](https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/authentication-management/access-token/get-user-access-token)。示例值："Bearer u-cjz1eKCEx289x1TXEiQJqAh5171B4gDHPq00l0GE1234" |
| Content-Type  | string | 是   | ​**固定值**​："application/json; charset=utf-8"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |

### 路径参数

| 名称                   | 类型       | 描述                                                                                                                                                                                                                                                                                                                                                                                                       |
| ------------------------ | ------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **spreadsheet\_token** | **string** | 电子表格的 token。可通过以下两种方式获取。了解更多，参考[电子表格概述](https://open.feishu.cn/document/ukTMukTMukTM/uATMzUjLwEzM14CMxMTN/overview)。* 电子表格的 URL：https://sample.feishu.cn/sheets/==Iow7sNNEphp3WbtnbCscPqabcef==* 调用[获取文件夹中的文件清单](https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/reference/drive-v1/file/list)​**示例值**​："Iow7sNNEphp3WbtnbCscPqabcef" |

### 请求示例

如需根据实际场景调整请求参数，可打开  输入请求参数，即可快速复制对应的调用代码

cURL

Go SDK

Python SDK

Java SDK

Node SDK

Php - Guzzle

C# - Restsharp

1

2

## 响应

### 响应体

| 名称                      | 类型                 | 描述                                                                                                                                                                                                   |
| --------------------------- | ---------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **code**                  | **int**              | 错误码，非 0 表示失败                                                                                                                                                                                  |
| **msg**                   | **string**           | 错误描述                                                                                                                                                                                               |
| **data**                  | **-**                | -                                                                                                                                                                                                      |
| **sheets**                | **sheet[]**          | 工作表列表                                                                                                                                                                                             |
| **sheet\_id**             | **string**           | 工作表 ID                                                                                                                                                                                              |
| **title**                 | **string**           | 工作表标题                                                                                                                                                                                             |
| **index**                 | **int**              | 工作表索引位置，索引从 0 开始计数。                                                                                                                                                                    |
| **hidden**                | **boolean**          | 工作表是否被隐藏* `true`：被隐藏* `false`：未被隐藏                                                                                                                                          |
| **grid\_properties**      | **grid\_properties** | 单元格属性，仅当 `resource_type` 为 `sheet` 即工作表类型为电子表格时返回。                                                                                                                     |
| **frozen\_row\_count**    | **int**              | 冻结的行数量                                                                                                                                                                                           |
| **frozen\_column\_count** | **int**              | 冻结的列数量                                                                                                                                                                                           |
| **row\_count**            | **int**              | 工作表的行数                                                                                                                                                                                           |
| **column\_count**         | **int**              | 工作表的列数量                                                                                                                                                                                         |
| **resource\_type**        | **string**           | 工作表类型* `sheet`：工作表* `bitable`：多维表格。详情参考[多维表格概述](https://open.feishu.cn/document/ukTMukTMukTM/uUDN04SN0QjL1QDN/bitable-overview)* `#UNSUPPORTED_TYPE`：不支持的类型 |
| **merges**                | **merge\_range[]**   | 合并单元格的相关信息。没有合并单元格则不返回。                                                                                                                                                         |
| **start\_row\_index**     | **int**              | 起始行，从 0 开始计数                                                                                                                                                                                  |
| **end\_row\_index**       | **int**              | 结束行，从 0 开始计数                                                                                                                                                                                  |
| **start\_column\_index**  | **int**              | 起始列，从 0 开始计数。                                                                                                                                                                                |
| **end\_column\_index**    | **int**              | 结束列，从 0 开始计数。                                                                                                                                                                                |

### 响应体示例

```
{
    "code": 0,
    "msg": "success",
    "data": {
        "sheets": [
            {
                "sheet_id": "sxj5ws",
                "title": "title",
                "index": 0,
                "hidden": false,
                "grid_properties": {
                    "frozen_row_count": 0,
                    "frozen_column_count": 0,
                    "row_count": 200,
                    "column_count": 20
                },
                "resource_type": "sheet",
                "merges": [
                    {
                        "start_row_index": 0,
                        "end_row_index": 0,
                        "start_column_index": 0,
                        "end_column_index": 0
                    }
                ]
            }
        ]
    }
}
```

### 错误码

| HTTP状态码 | 错误码  | 描述                  | 排查建议                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ------------ | --------- | ----------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 400        | 1310251 | Invalid Parameter     | 参考响应体中的错误提示                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 400        | 1310213 | Permission Fail       | 当前调用身份没有电子表格的阅读（获取相关接口）或编辑（创建、更新等相关接口）权限。请参考以下方式解决：* 如果你使用的是 `tenant_access_token`，意味着当前应用没有电子表格的阅读或编辑权限。你需通过电子表格网页页面右上方 **「...」** -> **「...更多」** ->**「添加文档应用」** 入口为应用添加权限。​**说明**​：在 **添加文档应用** 前，你需确保目标应用至少开通了一个云文档 [API 权限](https://open.feishu.cn/document/ukTMukTMukTM/uYTM5UjL2ETO14iNxkTN/scope-list)。否则你将无法在文档应用窗口搜索到目标应用。![](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/22c027f63c540592d3ca8f41d48bb107_CSas7OYJBR.png?height=1994&maxWidth=550&width=3278)* 如果你使用的是 `user_access_token`，意味着当前用户没有电子表格的阅读或编辑权限。你需通过电子表格网页页面右上方 **分享** 入口为当前用户添加权限。![image.png](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/3e052d3bac56f9441296ae22e2969d63_a2DEYrJup8.png?height=278&maxWidth=550&width=1383)了解具体操作步骤或其它添加权限方式，参考[云文档常见问题 3](https://open.feishu.cn/document/ukTMukTMukTM/uczNzUjL3czM14yN3MTN#16c6475a)。 |
| 400        | 1310249 | Spreadsheet Deleted   | 恢复表格后重试                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| 400        | 1310214 | SpreadSheet Not Found | 检查表格 token                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| 500        | 1315201 | Server Error          | 服务内部错误，[详询客服](https://applink.feishu.cn/client/helpdesk/open?id=6626260912531570952)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 500        | 1315203 | Server Error          | 服务内部错误，[详询客服](https://applink.feishu.cn/client/helpdesk/open?id=6626260912531570952)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 500        | 1315210 | Server Error          | 服务内部错误，[详询客服](https://applink.feishu.cn/client/helpdesk/open?id=6626260912531570952)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
